# 4. ShareRestaurant CRUD

## CURD 구성하기

### 1. category CRUD

- model 정의

  - 하나의 맛집이 하나의 카테고리에 속하도록 정의

  ```python
  from django.db import models
  
  # Create your models here.
  class Category(models.Model):
      category_name = models.CharField(max_length = 100)
  ```

- DB에 반영

```
python manage.py makemigrations
python manage.py migrate
```

- shareRes/urls.py 수정
  - redirect하기 위하여 path에 name을 추가해 줌
  -  path('categoryCreate/create',views.Create_category, name='cateCreate'), 가 없으면 에러 발생

```python
from django.urls import path, include
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('restaurantDetail/',views.restaurantDetail, name='resDetailPage'),
    path('restaurantCreate/',views.restaurantCreate, name='resCreatePage'),
    path('categoryCreate/',views.categoryCreate, name='cateCreatePage'),
    path('categoryCreate/create',views.Create_category, name='cateCreate'),
]
```

- shareRes/views.py 수정 - Create_category 수정

```python
from django.shortcuts import render
from django.http import HttpResponse, HttpResponseRedirect
from django.urls import reverse
from .models import * #모델 사용

# Create your views here.
def index(request):
    categories = Category.object.all()
    content = {'categories' : categories}
    return render(request, 'shareRes/index.html', content)

def restaurantDetail(request):
    return render(request, 'shareRes/restaurantDetail.html')

def restaurantCreate(request):
    return render(request, 'shareRes/restaurantCreate.html')

#카테고리 추가 화면을 보여줌
def categoryCreate(request):
    return render(request, 'shareRes/categoryCreate.html')

#카테고리 추가 버튼을 눌렀을 때 동작
def Create_category(request):
    category_name = request.POST['categoryName']
    new_category = Category(category_name = category_name)
    new_category.save() #데이터베이스에 저장
    return HttpResponseRedirect(reverse('index')) #리다이렉트
```

- shareRes/templates/shareRes/index.html 수정

```
 <ul class="restaurantListDiv nav nav-pills nav-stacked">
                           {% for category in categories %}
                           <li class="category deactive">{{ category.category_name }}</li>
                           <ul class="restaurantList">
                               
                            <div class="input-group">
                                <span class="input-group-addon">
                                    <input name="check1" id="check1" type="checkbox">
                                </span>
                                <a href="restaurantDetail/1"><input name="res1" id="res1" type="text" class="form=control" disabled style="cursor:pointer;" value="1"></a>
                            </div>

                            <div class="input-group">
                                <span class="input-group-addon">
                                    <input name="check2" id="check2" type="checkbox">
                                </span>
                                <a href="restaurantDetail/2"><input name="res2" id="res2" type="text" class="form-control" disabled style="cursor:pointer;" value="2"></a>
                            </div>
                        
                           </ul>
                           {% endfor %}
                        </ul>
```

- shareRes/views.py 수정 - categoryCreate 수정

```python
from django.shortcuts import render
from django.http import HttpResponse, HttpResponseRedirect
from django.urls import reverse
from .models import * #모델 사용

# Create your views here.
def index(request):
    categories = Category.objects.all()
    content = {'categories' : categories}
    return render(request, 'shareRes/index.html', content)

def restaurantDetail(request):
    return render(request, 'shareRes/restaurantDetail.html')

def restaurantCreate(request):
    return render(request, 'shareRes/restaurantCreate.html')

#카테고리 추가 화면을 보여줌
def categoryCreate(request):
    categories = Category.objects.all()
    content = {'categories' : categories}
    return render(request, 'shareRes/categoryCreate.html', content)

#카테고리 추가 버튼을 눌렀을 때 동작
def Create_category(request):
    category_name = request.POST['categoryName']
    new_category = Category(category_name = category_name)
    new_category.save() #데이터베이스에 저장
    return HttpResponseRedirect(reverse('index')) #리다이렉트
```

- shareRes/templates/shareRes/categoryCreate.html 수정

```html
 {% for category in categories %}
                    <form action="" method="POST">
                        <div class="input-group">
                            <span class="input-group-addon" id="" style="border:1px solid #ccc; border-radius: 4px;">한식</span>
                            <input type="hidden" name="categoryId" id="categoryId" value="{{category.id}}"/>
                            <input type="submit" class="resAddBtn btn btn-danger" role="button" value="삭제"/>
                        </div>
                    </form>
                    {% endfor %}
```

### 최종코드

- shareRes/templates/shareRes/categoryCreate.html

```html
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Boot strap -->
    <!-- 합쳐지고 최소화된 최신 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- 부가적인 테마 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!-- 합쳐지고 최소화된 최신 자바스크립트 -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <style>
        .container{
            margin-top: 20px;
        }
        .jumbotron{
            padding-top:15px;
            padding-bottom:15px;
        }
        .content{
            min-height: 60%;
            margin: auto;
        }
        .row{
            margin:0;
            padding:0;
        }
        .inputDiv{
            margin-left: 200px;
            margin-right: 200px;
            margin-bottom: 50px;
        }
        .input-group-addon{
            width:700px;
        }
        .resCategory{
            width:300px;
            border-radius: 10px;
        }
        .input-group{
            margin:10px;
            width: 730px;
        }
        .resAddBtn{
            float:right;
        }

        .panel-footer{
            margin-top: 50px;
            height: 10%;
        }
    </style>
    <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous">
    </script>
    <title>맛집 추가하기</title>
    <script>
        function categoryAddCheckFrom(){
            if($('#categoryName').val().length <= 0){
                alert('추가할 카테고리 이름을 입력해주세요.')
                $('#categoryName').focus()
                return false;
            }
            else{
                return true;
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="jumbotron">
                <h1>카테고리 추가하기</h1>
                <p>made by Django</p>
            </div>
        </div>
        <div class="content">
            
                <div class="inputDiv">
                    {% for category in categories %}
                    {% if category.id == 1%}
                        <div class="input-group">
                            <span class="input-group-addon" style="border:1px solid #ccc; border-radius: 4px;">
                            {{ category.category_name }}
                            </span>
                        </div>
                        {% endif %}
                        {% endfor %}
                    
                    {% for category in categories %}
                    {% if category.id != 3 %}
                    <form action="./delete" method="POST">{% csrf_token %}
                        <div class="input-group">
                            <span class="input-group-addon" id="" style="border:1px solid #ccc; border-radius: 4px;">{{category.category_name}}</span>
                            <input type="hidden" name="categoryId" id="categoryId" value="{{category.id}}"/>
                            <input type="submit" class="resAddBtn btn btn-danger" role="button" value="삭제"/>
                        </div>
                    </form>
                    {% endif %}
                    {% endfor %}

                    <form action="./create" method="POST" onsubmit="return categoryAddCheckFrom();">{% csrf_token %}
                        <div class="input-group">
                            <input type="submit" class="resAddBtn btn btn-success" role="button" value="추가"/>
                            <input id="categoryName" name="categoryName" type="text" class="form-control" placeholder="추가할 카테고리명을 입력하세요." style="width:650px; float:right; border-radius:4px;">
                        </div>
                    </form>
                    <a href ="/" class="resAddBtn btn btn-info" role="button">홈으로</a>
                </div>
            
        </div>
        <div class="panel-footer">
            실전예제로 배우는 Django. Project2-RestaurantShare
        </div>
    </div>
</body>
</html>
```

- shareRes/urls.py

```python
from django.urls import path, include
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('restaurantDetail/',views.restaurantDetail, name='resDetailPage'),
    path('restaurantCreate/',views.restaurantCreate, name='resCreatePage'),
    path('categoryCreate/',views.categoryCreate, name='cateCreatePage'),
    path('categoryCreate/create',views.Create_category, name='cateCreate'),
    path('categoryCreate/delete',views.Delete_category, name='cateDelete'),
]
```

- shareRes/views.py

```python
from django.shortcuts import render
from django.http import HttpResponse, HttpResponseRedirect
from django.urls import reverse
from .models import * #모델 사용

# Create your views here.
def index(request):
    categories = Category.objects.all()
    content = {'categories' : categories}
    return render(request, 'shareRes/index.html', content)

def restaurantDetail(request):
    return render(request, 'shareRes/restaurantDetail.html')

def restaurantCreate(request):
    return render(request, 'shareRes/restaurantCreate.html')

#카테고리 추가 화면을 보여줌
def categoryCreate(request):
    categories = Category.objects.all()
    content = {'categories' : categories}
    return render(request, 'shareRes/categoryCreate.html', content)

#카테고리 추가 버튼을 눌렀을 때 동작
def Create_category(request):
    category_name = request.POST['categoryName']
    new_category = Category(category_name = category_name)
    new_category.save() #데이터베이스에 저장
    return HttpResponseRedirect(reverse('index')) #리다이렉트


#카테고리 삭제
def Delete_category(request):
    category_id = request.POST['categoryId']
    delete_category = Category.objects.get(id = category_id)
    deltete_categoery.delete()
    return HttpResponseRedirect(reverse('cateCreatePage'))
```



### 2. restaurant CRUD

### shareRes/templates/shareRes/restaurantCreate.html수정

```html
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Boot strap -->
    <!-- 합쳐지고 최소화된 최신 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- 부가적인 테마 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!-- 합쳐지고 최소화된 최신 자바스크립트 -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <style>
        .container{
            margin-top: 20px;
        }
        .jumbotron{
            padding-top:15px;
            padding-bottom:15px;
        }
        .content{
            min-height: 60%;
            margin: auto;
        }
        .row{
            margin:0;
            padding:0;
        }
        .inputDiv{
            margin-left: 200px;
            margin-right: 200px;
            margin-bottom: 50px;
        }
        select[size]{
            height: 28px;
        }
        .resCategory{
            width:300px;
            border-radius: 10px;
        }
        .input-group{
            margin:10px;
            width: 730px;
        }
        .resAddBtn{
            float:right;
        }

        .panel-footer{
            margin-top: 50px;
            height: 10%;
        }
    </style>
    <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous">
    </script>
    <title>맛집 추가하기</title>
    <script>
        function checkFrom(){
            if ($('#resTitle').val().length <= 0){
                alert("맛집 이름을 입력해주세요.")
                $('#resTitle').focus()
                return false
            }else if($('#resLink').val().length <= 0){
                alert("관련 링크를 입력해주세요.")
                $('#resLink').focus()
                return false
            }else if($('#resContent').val().length <= 0){
                alert("상세 내용을 입력해주세요.")
                $('#resContent').focus()
                return false
            }else if($('#resLoc').val().length <= 0){
                alert("장소 키워드를 입력해주세요.")
                $('#resLoc').focus()
                return false
            }else{
                return true
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="jumbotron">
                <h1>맛집 추가하기</h1>
                <p>made by Django</p>
            </div>
        </div>
        <div class="content">
            <form action="./create" method="POST" onsubmit="return checkFrom();">{% csrf_token %}
                <div class="inputDiv">
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">카테고리</span>
                        <select id="resCategory" name="resCategory" class="resCategory" size="1" required autofocus>
                            {% for category in categories %}
                            {% if category.id == 3 %}
                            <option value="{{category.id}}" selected>{{category.category_name}}</option>
                            {% else %}
                            <option value="{{category.id}}">{{category.category_name}}</option>
                            {% endif %}
                            {% endfor %}
                        </select>  
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">맛집 이름</span>
                        <input id="resTitle" name="resTitle" type="text" class="form-control" placeholder="맛집 이름을 입력해주세요." aria-describedby="sizing-addon2">
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">관련 링크</span>
                        <input id="resLink" name="resLink" type="text" class="form-control" placeholder="관련 링크를 입력해주세요." aria-describedby="sizing-addon2">
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">상세 내용</span>
                        <textarea id="resContent" name="resContent" cols="90" rows="10" placeholder="상세 내용을 입력해주세요."></textarea>
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">장소 키워드</span>
                        <input id="resLoc" name="resLoc" type="text" class="form-control" placeholder="장소 키워드를 입력해주세요." aria-describedby="sizing-addon2">
                    </div>
                    <input type="submit" class="resAddBtn btn btn-info" role="button" value="맛집 추가!"/>
                </div>
            </form>
        </div>
        <div class="panel-footer">
            실전예제로 배우는 Django. Project2-RestaurantShare
        </div>
    </div>
</body>
</html>
```

### shareRes/models.py 수정

```python
from django.db import models

# Create your models here.
class Category(models.Model):
    category_name = models.CharField(max_length = 100)

class Restaurant(models.Model):
    category = models.ForeignKey(Category, on_delete=models.SET_DEFAULT, default=1)
    restaurant_name = models.CharField(max_length=100)
    restaurant_link = models.CharField(max_length=500)
    restaurant_content = models.TextField()
    restaurant_keyword = models.CharField(max_length=50)
```

- ForeignKey의 on_delete 옵션
  - SET_DEFAULT
    - 참조되는 요소가 삭제도리 때 이를 참조하는 요소에 대해서 참조 값을 설정해 둔 DEFAULT 값 으로 설정
    - 위의 코드에서 dfault 3 이므로 restaurant 요소가 참조하는 category가 삭제될 때 자동으로 id 값이 3인 category 참조
  - CASCADE
    - 요소가 삭제될 때 이를 참조하는 모든 요소도 함께 삭제
  - PROTECT
    - 참조되는 요소를 삭제할 때 해당 요소를 참조하는 요소가 하나라도 존재하면 에러 발생(ProtectedError)
  - SET_NULL
    - 참조되는 요소가 삭제될 때 참조하는 요소에 대하여 참조 값을 NULL로 설정
    - 사용하려면 해당 값을 null로 가질 수 있도록 null=True 설정 필요

### shareRes/urls.py 수정

```python
from django.urls import path, include
from . import views

urlpatterns = [
    path('', views.index, name='index'),
    path('restaurantDetail/delete',views.Delete_restaurant, name='resDelete'),
    path('restaurantDetail/<str:res_id>',views.restaurantDetail, name='resDetailPage'),
    path('restaurantDetail/updatePage/update', views.Update_restaurant, name="resUpdate"),
    path('restaurantDetail/updatePage/<str:res_id>',views.restaurantUpdate, name='resUpdatePage'),
    path('restaurantCreate/',views.restaurantCreate, name='resCreatePage'),
    path('restaurantCreate/create',views.Create_restaurant, name='resCreate'),
    path('categoryCreate/',views.categoryCreate, name='cateCreatePage'),
    path('categoryCreate/create',views.Create_category, name='cateCreate'),
    path('categoryCreate/delete',views.Delete_category, name='cateDelete'),
]
```

### shareRes/views.py 수정

```python
from django.shortcuts import render
from django.http import HttpResponse, HttpResponseRedirect
from django.urls import reverse
from .models import * #모델 사용

# Create your views here.
def index(request):
    categories = Category.objects.all()
    restaurants = Restaurant.objects.all()
    content = {'categories': categories, 'restaurants': restaurants}
    # return HttpResponse("index")
    return render(request, 'shareRes/index.html', content)

def restaurantDetail(request, res_id):
    restaurant = Restaurant.objects.get(id = res_id)
    content = {'restaurant': restaurant}
    # return render(request, 'shareRes/restaurantDetail.html')
    return render(request, 'shareRes/restaurantDetail.html', content)

#레스토랑 수정
def restaurantUpdate(request, res_id):
    categories = Category.objects.all()
    restaurant = Restaurant.objects.get(id = res_id)
    content = {'categories':categories, 'restaurant': restaurant}
    return render(request, 'shareRes/restaurantUpdate.html', content)

#레스토랑 삭제
def Delete_restaurant(request):
    res_id = request.POST['resId']
    restaurant = Restaurant.objects.get(id = res_id)
    restaurant.delete()
    return HttpResponseRedirect(reverse('index'))

#레스토랑 업데이트
def Update_restaurant(request):
    resId= request.POST['resId']
    change_category_id = request.POST['resCategory']
    change_category = Category.objects.get(id = change_category_id)
    change_name = request.POST['resTitle']
    change_link = request.POST['resLink']
    change_content = request.POST['resContent']
    change_keyword = request.POST['resLoc']
    before_restaurant = Restaurant.objects.get(id = resId)
    before_restaurant.category = change_category
    before_restaurant.restaurant_name = change_name
    before_restaurant.restaurant_link = change_link
    before_restaurant.restaurant_content = change_content
    before_restaurant.restaurant_keyword = change_keyword
    before_restaurant.save()
    return HttpResponseRedirect(reverse('resDetailPage', kwargs={'res_id':resId}))

#레스토랑 추가화면 보여줌
def restaurantCreate(request):
    categories = Category.objects.all()
    content = {'categories' : categories}
    # return render(request, 'shareRes/restaurantCreate.html')
    return render(request, 'shareRes/restaurantCreate.html', content)

#레스토랑 추가
def Create_restaurant(request):
    category_id = request.POST['resCategory']
    category = Category.objects.get(id = category_id)
    name = request.POST['resTitle']
    link = request.POST['resLink']
    content = request.POST['resContent']
    keyword = request.POST['resLoc']
    new_res = Restaurant(category=category, restaurant_name=name, restaurant_link=link, restaurant_content=content, restaurant_keyword=keyword)
    new_res.save()
    return HttpResponseRedirect(reverse('index'))

#카테고리 추가 화면을 보여줌
def categoryCreate(request):
    categories = Category.objects.all()
    content = {'categories' : categories}
    return render(request, 'shareRes/categoryCreate.html', content)

#카테고리 추가 버튼을 눌렀을 때 동작
def Create_category(request):
    category_name = request.POST['categoryName']
    new_category = Category(category_name = category_name)
    new_category.save() #데이터베이스에 저장
    return HttpResponseRedirect(reverse('index')) #리다이렉트


#카테고리 삭제
def Delete_category(request):
    category_id = request.POST['categoryId']
    delete_category = Category.objects.get(id = category_id)
    deltete_categoery.delete()
    return HttpResponseRedirect(reverse('cateCreatePage'))


```

### shareRes/templates/shareRes/index.html 수정

- 메인화면에서 restaurant 목록을 보여주도록 수정

```html
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Boot strap -->
    <!-- 합쳐지고 최소화된 최신 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- 부가적인 테마 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!-- 합쳐지고 최소화된 최신 자바스크립트 -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <style>
        .container{
            margin-top: 20px;
        }
        .jumbotron{
            padding-top:15px;
            padding-bottom:15px;
        }
        .content{
            min-height: 60%;
            margin: auto;
        }
        .row{
            margin:0;
            padding:0;
        }
        .subTitle{
            font-size:17px;
        }
        .addBtn{
            width: 400px;
            margin: 10px;
        }
        .restaurantInfoDiv{
            margin-left:30px;
            float:left;
        }
        .infoHeaderDiv{
            border-bottom: 1px solid #eee;
            float:left;
        }
        .infoHeaderDiv h1{
            margin:0;
        }
        .categoryAddDiv{
            float:left;
            margin-left:25px;
        }
        .categoryAddBtn{
            height: 40px;
            width: 40px;
            font-size:20px;
            padding:3px;

        }
        .restaurantListDiv{
            margin-top: 25px;
            width: 500px;
        }
        a{
            text-decoration: none;
        }
        .active{
            color: #fff;
            background-color: #337ab7;
        }
        .deactive{
            color: #337ab7;
            background-color: #fff;
        }
        .category{
            position: relative;
            display: block;
            cursor: pointer;
            border-radius: 4px;
            padding: 10px 15px;
            margin-top: 5px;
            margin-bottom: 10px;
        }
        .deactive:hover{
            background-color: #D3D3D3;
        }
        .restaurantList{
            display:none;
        }
        ul.restaurantList li{
            background-color:white;
        }
        ul.restaurantList li:hover{
            background-color:#D3D3D3;
            cursor: pointer;
        }
        .input-group{
            margin: 10px;
        }

        .emailDiv{
            float:left;
            margin-left:25px;
        }
        .emailContentGroup{
            margin:5px;
        }
        .emailHeaderDiv h1{
            margin:0;
        }
        .sendBtn{
            width: 400px;
            margin: 10px;
        }
        .emailContentGroup h4{
            font-weight: bold;
            margin:5px;
        }
        .emailContentHeader{
            margin: 10px;
        }
        .emailContent{
            margin: 10px;

        }
        .inputReceiver{
            width: 350px;
        }
        .inputReceiverSub{
            font-size: 12px;
            font-weight: 100;
        }
        .inputTitle{
            width: 350px;
        }
        .inputContent{
            resize: none;
        }


        .panel-footer{
            margin-top: 50px;
            height: 10%;
        }
    </style>
    <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous">
    </script>
    <script>
        $(document).ready(function(){
            $('.restaurantListDiv>li').click(function(){
                if ($(this).hasClass('active')){
                    $(this).addClass('deactive')
                    $(this).removeClass('active')
                    $(this).next('ul').slideUp();
                }else{
                    $(this).removeClass('deactive')
                    $(this).addClass('active')
                    $(this).next('ul').slideDown();
                }

                
            })
        });

        function emailCheckForm(){
            var isCheckLessThanOne = true
            for(i = 1; i <= 6; i++){
                var idString = "check"+i
                var isChecked = $("#"+idString).is(':checked')
                console.log("check"+i,isChecked)
                if (isChecked){
                    isCheckLessThanOne = false
                    break
                }
            }
            console.log(isCheckLessThanOne)
            if($('#inputReceiver').val().length <= 0){
                alert("이메일 수신자를 1명 이상 입력해주세요.")
                $('#inputReceiver').focus()
                return false
            }else if($('#inputTitle').val().length <= 0){
                alert("이메일 제목을 입력해주세요.")
                $('#inputTitle').focus()
                return false
            }else if(isCheckLessThanOne){
                alert("맛집을 하나 이상 선택해주세요.")
                return false
            }else{
                return true;
            }
        }

    </script>
    <title>맛집 공유 사이트</title>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="jumbotron">
                <h1>맛집 공유 사이트</h1>
                <p>made by Django</p>
            </div>
        </div>
        <div class="content">
            <div class="row">
                <form action="" method="POST" onsubmit="return emailCheckForm();"> {% csrf_token %}
                    <div class="restaurantInfoDiv ">
                        <div class="row">
                            <div class="infoHeaderDiv">
                                <h1>Category <small class="subTitle">상세내용을 보려면 클릭하세요.</small></h1>
                            </div>
                            <div class="categoryAddDiv">
                                    <a href="categoryCreate/" class="categoryAddBtn btn btn-info" role="button">+</a>
                            </div>
                        </div>
                        
                        <ul class="restaurantListDiv nav nav-pills nav-stacked">
                                {% for category in categories %}
                                <li class="category deactive">{{ category.category_name}}</li>
                                <ul class="restaurantList">
    
                                    {% for restaurant in restaurants %}
                                    {% if restaurant.category == category %}
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <input name="checks" id="check{{restaurant.id}}" type="checkbox" value="{{restaurant.id}}">
                                        </span>
                                        <a href="restaurantDetail/{{restaurant.id}}"><input name="res{{restaurant.id}}" id="res{{restaurant.id}}" type="text" class="form-control" disabled style="cursor: pointer;" value="{{restaurant.restaurant_name}}"></a>
                                    </div>
                                    {% endif %}
                                    {% endfor %}
    
                                </ul>
                                {% endfor %}
                        </ul>
                        <a href="restaurantCreate/" class="sendBtn btn btn-info" role="button">맛집 추가하기</a>
                    </div>
                    <div class="emailDiv">
                        <div class="emailHeaderDiv">
                            <h1>Email <small class="subTitle">수신자와 제목,인사말을 적어주세요.</small></h1>
                        </div>
                        <div class="emailContentGroup">

                            <div class="emailContentHeader">
                                <h4>수신자 <span class="inputReceiverSub">콤마(,)로 구분해서 여러명에게 보낼 수 있습니다.</span></h4>
                                <input class="inputReceiver" name="inputReceiver" id="inputReceiver" type="text" placeholder="수신자를 적어주세요."/><br/>
                            </div>
                            <div class="emailContentHeader">
                                <h4>제목</h4>
                                <input class="inputTitle" name="inputTitle" id="inputTitle" type="text" placeholder="제목을 적어주세요."/><br/>
                            </div>
                            <div class="emailContent">
                                <h4>인사말</h4>
                                <textarea class="inputContent" name="inputContent" id="inputContent" cols="50" rows="10" placeholder="인사말을 적어주세요."></textarea>
                            </div>
                            
                        </div>
                        <div>
                            <input type="submit" class="sendBtn btn btn-info" role="button" value="이메일 발송하기"/>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="panel-footer">
            실전예제로 배우는 Django. Project2-RestaurantShare
        </div>
    </div>
</body>
</html>
```

### shareRes/templates/shareRes/restaurantDetail.html 수정

```html
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Boot strap -->
    <!-- 합쳐지고 최소화된 최신 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- 부가적인 테마 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!-- 합쳐지고 최소화된 최신 자바스크립트 -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <style>
        .container{
            margin-top: 20px;
        }
        .jumbotron{
            padding-top:15px;
            padding-bottom:15px;
        }
        .content{
            min-height: 60%;
            margin: auto;
        }
        .row{
            margin:0;
            padding:0;
        }
        .inputDiv{
            margin-left: 200px;
            margin-right: 200px;
            margin-bottom: 50px;
        }
        select[size]{
            height: 28px;
        }
        .resCategory{
            width:300px;
            border-radius: 10px;
        }
        .input-group{
            margin:10px;
            width: 730px;
        }
        .resAddBtn{
            float:right;
        }

        .panel-footer{
            margin-top: 50px;
            height: 10%;
        }
    </style>
    <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous">
    </script>
    <title>맛집 추가하기</title>
    <script>
        function checkFrom(){
            if ($('#resTitle').val().length <= 0){
                alert("맛집 이름을 입력해주세요.")
                $('#resTitle').focus()
                return false
            }else if($('#resLink').val().length <= 0){
                alert("관련 링크를 입력해주세요.")
                $('#resLink').focus()
                return false
            }else if($('#resContent').val().length <= 0){
                alert("상세 내용을 입력해주세요.")
                $('#resContent').focus()
                return false
            }else if($('#resLoc').val().length <= 0){
                alert("장소 키워드를 입력해주세요.")
                $('#resLoc').focus()
                return false
            }else{
                return true
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="jumbotron">
                <h1>맛집 상세보기</h1>
                <p>made by Django</p>
            </div>
        </div>
        <div class="content">
            <div class="inputDiv">
                <div class="input-group">
                    <span class="input-group-addon" id="sizing-addon2">카테고리</span>
                    <input id="resCategory" name="resCategory" type="text" class="form-control" disabled value="{{restaurant.category.category_name}}">
                </div>
                <div class="input-group">
                    <span class="input-group-addon" id="sizing-addon2">맛집 이름</span>
                    <input id="resTitle" name="resTitle" type="text" class="form-control" disabled value="{{restaurant.restaurant_name}}">
                </div>
                <div class="input-group">
                    <span class="input-group-addon" id="sizing-addon2">관련 링크</span>
                    <input id="resLink" name="resLink" type="text" class="form-control" disabled value="{{restaurant.restaurant_link}}">
                </div>
                <div class="input-group">
                    <span class="input-group-addon" id="sizing-addon2">상세 내용</span>
                    <textarea id="resContent" name="resContent" cols="90" rows="10" disabled>{{restaurant.restaurant_content}}</textarea>
                </div>
                <div class="input-group">
                    <span class="input-group-addon" id="sizing-addon2">장소 키워드</span>
                    <input id="resLoc" name="resLoc" type="text" class="form-control" disabled value="{{restaurant.restaurant_keyword}}">
                </div>
                <a href ="/" class="resAddBtn btn btn-info" role="button">홈으로</a>
                <a href ="./updatePage/{{restaurant.id}}" class="resAddBtn btn btn-danger" role="button">수정하기</a>
                <form action ="./delete" method="POST">{% csrf_token %}
                <input type="hidden" id="resId" name="resId" value="{{restaurant.id}}">
                <input type="submit" class="resAddBtn btn btn-danger" value="삭제하기">
            </form>
            </div>
        </div>
        <div class="panel-footer">
            실전예제로 배우는 Django. Project2-RestaurantShare
        </div>
    </div>
</body>
</html>
```

### shareRes/templates/shareRes/restaurantUpdate.html 생성

- restaurantCreate.html 파일을 복사하여 이름을 바꿔준다

```html
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Boot strap -->
    <!-- 합쳐지고 최소화된 최신 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- 부가적인 테마 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!-- 합쳐지고 최소화된 최신 자바스크립트 -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <style>
        .container{
            margin-top: 20px;
        }
        .jumbotron{
            padding-top:15px;
            padding-bottom:15px;
        }
        .content{
            min-height: 60%;
            margin: auto;
        }
        .row{
            margin:0;
            padding:0;
        }
        .inputDiv{
            margin-left: 200px;
            margin-right: 200px;
            margin-bottom: 50px;
        }
        select[size]{
            height: 28px;
        }
        .resCategory{
            width:300px;
            border-radius: 10px;
        }
        .input-group{
            margin:10px;
            width: 730px;
        }
        .resAddBtn{
            float:right;
        }

        .panel-footer{
            margin-top: 50px;
            height: 10%;
        }
    </style>
    <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous">
    </script>
    <title>맛집 수정하기</title>
    <script>
        function checkFrom(){
            if ($('#resTitle').val().length <= 0){
                alert("맛집 이름을 입력해주세요.")
                $('#resTitle').focus()
                return false
            }else if($('#resLink').val().length <= 0){
                alert("관련 링크를 입력해주세요.")
                $('#resLink').focus()
                return false
            }else if($('#resContent').val().length <= 0){
                alert("상세 내용을 입력해주세요.")
                $('#resContent').focus()
                return false
            }else if($('#resLoc').val().length <= 0){
                alert("장소 키워드를 입력해주세요.")
                $('#resLoc').focus()
                return false
            }else{
                return true
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="jumbotron">
                <h1>맛집 수정하기</h1>
                <p>made by Django</p>
            </div>
        </div>
        <div class="content">
            <form action="./update" method="POST" onsubmit="return checkFrom();">{% csrf_token %}
                <div class="inputDiv">
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">카테고리</span>
                        <select id="resCategory" name="resCategory" class="resCategory" size="1" required autofocus>
                            {% for category in categories %}
                            {% if category == restaurant.category %}
                            <option value="{{category.id}}" selected>{{category.category_name}}</option>
                            {% else %}
                            <option value="{{category.id}}">{{category.category_name}}</option>
                            {% endif %}
                            {% endfor %}
                        </select>  
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">맛집 이름</span>
                        <input id="resTitle" name="resTitle" type="text" class="form-control" placeholder="맛집 이름을 입력해주세요." aria-describedby="sizing-addon2" value="{{restaurant.restaurant_name}}">
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">관련 링크</span>
                        <input id="resLink" name="resLink" type="text" class="form-control" placeholder="관련 링크를 입력해주세요." aria-describedby="sizing-addon2" value="{{restaurant.restaurant_link}}">
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">상세 내용</span>
                        <textarea id="resContent" name="resContent" cols="90" rows="10" placeholder="상세 내용을 입력해주세요.">{{restaurant.restaurant_content}}</textarea>
                    </div>
                    <div class="input-group">
                        <span class="input-group-addon" id="sizing-addon2">장소 키워드</span>
                        <input id="resLoc" name="resLoc" type="text" class="form-control" placeholder="장소 키워드를 입력해주세요." aria-describedby="sizing-addon2" value="{{restaurant.restaurant_keyword}}">
                    </div>
                    <input type="hidden" id="resId" name="resId" value="{{restaurant.id}}"/>
                    <input type="submit" class="resAddBtn btn btn-info" role="button" value="맛집 수정!"/>
                </div>
            </form>
        </div>
        <div class="panel-footer">
            실전예제로 배우는 Django. Project2-RestaurantShare
        </div>
    </div>
</body>
</html>
```

### DB반영

- python manage.py makemigrations
- python manage.py migrate