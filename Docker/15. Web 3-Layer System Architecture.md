# 15. Web 3-Layer System Architecture

제품환경에서는 애플리케이션 서버, 로그 서버, 프록시 서버 등 여러 컨테이너의 연계가 필요함

## 웹 3계층 시스템 아키텍처

인프라 아키텍처 : 여러 개의 서버에 기능과 역할을 분할하여 인프라의 전체 구성을 정함

대규모 웹 시스템의 경우 몇 개의 서브 시스템/기능으로 나누어 시스템을 개발

### 프론트 서버(웹 서버)

- 클라이언트의 웹 브라우저가 보낸 HTTP Request를 받아 Response를 하는 것
- 미들웨어로 구축하거나, Nginx, IIS(MS에서 서비스하는 Internet Information Services)등이 있음
- 요청의 처리가 메인 업무이므로 부하가 높은 경우에는 스케일러블하게 처리 대수를 늘리고, 로드밸런서등으로 부하분산을 함

### 애플리케이션 서버

- 업무 처리를 실행하는 서버
- 결제처리, 수주 처리 등 애플리케이션의 처리를 실행하는 프로그램의 실행 환경
- 미들웨어로 구축하는 경우도 있음

### 데이터베이스(DB) 서버

- 영구 데이터 관리를 위한 서버
- RDBMS 기능을 갖는 미들웨어에서 관리
- MySQL, PostgreSQL, Oracle DB / NoSQL인 MongoDB, Redis 등이 있음

#### *미들웨어란

> 컴퓨터 제작 회사가 사용자의 요구대로 만들어 제공하는 프로그램으로, 운영 체제와 의 중간에서 조정과 중개의 역할을 수행하는 소프트웨어이다. 응용 소프트웨어가 운영 체제로부터 제공받는 서비스 이외에 추가적으로 이용할 수 있는 서비스를 제공하는 컴퓨터 소프트웨어이다.
>
> 종류 : RPC(원격프로시저호출), 메시지 지향 미들웨어, DB미들웨어 등

## 영구 데이터의 관리

### 데이터의 백업 및 복원

- 서버 장애에 대비해 데이터를 백업
- 보안대책이나 운용규칙 필요

### 로그 수집

- 여러 개의 서버로 된 분산 환경에서 통합 감시를 하는 경우는 로그 수집 전용 서버를 마련하는것이 일반적
- 사용자 인증 시의 액세스 로그 등은 보안의 감사 로그로서 장기 저장이 의무화되는 경우가 있음
- Unix 계열 OS의 경우 SYSLOGD라는 데몬을 사용하여 커널이나 애플리케이션으로부터 수집한 로그를 관리
- Docker는 컨테이너를 사용하여 서버 기능을 제공하며, 필요에 따라 생성하거나 파기하는 운용에 적합함
- 하나의 컨테이너에는 하나의 프로세스를 구성해 두는 것이 대원칙

### *컨테이너에서 영구 데이터를 다룰 때 주의점

- 웹 시스템에서는 고객정보나 매출정보 등 없어지면 안되는 데이터가 저장됨.
- 미션 크리티컬 시스템이라는 시스템으로 다중 구성을하거나 장애 및 사고에 대비함
- 원격지에 백업이나 세대 관리등을 하는 것이 일반적
- 한편, Docker 컨테이너는 트래픽의 증감에 따라 생성 및 파기하는 운용에 적합

### Docker Compose

- 여러개의 컨테이너를 모아서 관리하기 위한 툴
- Compose 정의 파일은 웹 어플리케이션의 의존관계를 모아서 설정할 수 있음
  - 의존관계 : DB, 큐, 캐시, 어플리케이션 등
- 여러개의 컨테이너들을 모아 시작하거나 정지 시킬 수 있으며, 구성정보를 YAML 형식의 파일로 관리하여 지속적인 배포와 지속적인 통합 프로세스가 가능하여 자동 테스트 환경에 적합