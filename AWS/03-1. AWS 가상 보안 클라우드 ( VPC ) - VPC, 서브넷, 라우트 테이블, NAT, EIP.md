# 03-1. AWS 가상 보안 클라우드 ( VPC ) - VPC, 서브넷, 라우트 테이블, NAT, 이그레스 온리 인터넷 게이트웨이, EIP
- VPC : 클라우드를 public, private 영역으로 분리
- 3Tier : 웹, 앱, DB(프라이빗 서브넷)

## 아마존 VPC : 클라우드 내 프라이빗 공간 제공
- CIRD(Class Inter Domain Routing) 블록을 이용한 범위 결정
- IPv4 CIRD 범위 : /16 -> 65536 주소 
- IPv6 CIRD 범위 : /56으로 고정. 직접적으로 IPv6의 IP 범위 설정 불가
- * 한번 생성된 VPC의 주소는 변경 불가

## 서브넷 : IP 네트워크의 논리적인 하위 부분
- 하나의 네트워크를 여러 개로 분리
	- 퍼블릭 - 인터넷을 통해 연결되는 리소스
	- 프라이빗 - 인터넷으로 연결하지 않고 보안 유지를 위한 배타적인 연결에 사용
	- VPN 온리 - 기업 데이터 센터와 버추얼 프라이빗 클라우드 연결에 사용
- 서브넷은 AZ 단위로 생성, 여러 개의 AZ가 있다면 여러 개의 서브넷 생성
- VPC는 리전 단위로 생성하며 여러 개의 리전이 있다면 여러개의 VPC 생성

## 라우트 테이블 : 전송 방향을 결정하는 라우트와 관련된 규칙을 담은 테이블
- 모든 서브넷은 라우트 테이블을 지닌다.
- 별도의 라우트 테이블을 생성하지 않으면 자동으로 VPC의 메인 라우트 테이블과 연결
- VPC의 기본 라우트 테이블
	- 자동으로 생성 및 수정 불가
	- 모든 IPv4 주소를 위한 주소 -> 0.0.0.0/0
	- 모든 IPv6 주소를 위한 주소 -> ::/0

## 인터넷 게이트웨이 : VPC가 인터넷에 연결되도록 하는 요소
## 네트워크 주소 변환 ( NAT )
- 기본적으로 인터넷 연결이 불가능한 프리이빗 서브넷에 접근 가능
- IPv4만 사용 가능
- 트래픽 -> IPv4주소의 소스가 NAT 기기의 주소로 변환 -> 프라이빗 서브넷 접근
- AWS의 NAT 기기 타입
	- NAT 인스턴스
		-  프라이빗 서브넷은 퍼블릭 서브넷의 NAT 인스턴스를 통해 인터넷과 연결된다.
		- 트래픽 흐름 : * DB(프라이빗) -> NAT -> 인터넷(퍼블릭) => 반대로의 흐름은 불가능하다.
		- SPOF(Single Point Of Failure) : 단일 실패 지점
			- 해결을 위해 다른 AZ에 NAT 인스턴스 중복 구현 또는 다른 AZ에서 액티브 및 패시브 모드로 NAT 인스턴스 실행
	- NAT 게이트웨이 : 기본적으로 ANT 인스턴스와 동일한 기능 수행
		- 완전 관리형 서비스로서 고정적인 네트워크 관리작업을 줄일 수 있다.
		- 사용 -> 실무에서는 NAT 인스턴스보다 NAT 게이트웨이를 선호한다. (가용성 및 대역폭이 높음)
			- Elastic IP 설정
			- 프라이빗 서브넷에 있는 서버에 NAT 게이트웨이 부착
			- 프라이빗 서브넷의 라우트 테이블 엔트리에 NAT 인스턴스 대신 NAT 게이트웨이 추가
			
## 이그레스 온리 인터넷 게이트웨이
- NAT 게이트웨이와 비슷한 기능 담당
- IPv6 기반 인터넷 트래픽의 이동 담당
- IPv6 서브넷 내부에서 외부로 나가는 아웃 바운드만 가능

## 일래스틱 네트워크 인터페이스 ( ENI, Elastic Network Interface )
- 하나 이상의 네트워크를 생성하고 인스턴스에 붙이는 역할
- ENI의 수는 전송량이나 대역폭에 영향을 주지 않는다 -> 수를 늘려도 성능개선이 되지 않음

## 일래스틱 IP 주소 (EIP)
- 클라우드에서 실행되는 어플리케이션을 위한 주소체계
- 새로운 EC2 인스턴스 생성 시 새로운 IP 주소 생성
-> 셧다운 후 재실행 시 IP 주소 변경됨 => EIP로 해결
- EIP를 인스턴스와 연결 -> EC2의 IP 주소가 변경될 때마다 EIP가 연결된 인스턴스와 연결
- IPv4만 지원




