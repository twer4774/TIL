# 07-3. AWS 어플리케이션 배포 및 모니터링 서비스 - 방화벽, SQS
## AWS 웹 어플리케애션 방화벽 (WAF)
- 기능
	- 침해 시도로부터 보호 : 커스텀 보안 규칙 작성을 통해 SQL 인젝션 공격, 크로스 사이트 스크립팅(XSS) 공격 등 주요 침해 시도로부터 리소스를 보호
	- 악성 요청 대응 : 웹 크롤러에 의한 대량의 데이터 침탈 시도 방지
	- DDoS 공격 방어 : HTTP/HTTPS 요청 공격(DDoS) 방어
- 일반 규칙 : 특정 요청을 목표로하는 조건
- 비율 규칙 : 5분 가격으로 비율 제한 적용

## Amazon SQS (Simple Queue Service)
- 클라우드를 통해 확장성, 장애 대응성, 가용성을 구현 -> 분산 시스템
- 분산 시스템 구현을 위해 CAP이론, 종국적 일관성, 분산 트랜잭션, 분산 디자인 패턴 반영
- 메시징 기법을 클라우드에서 분산 아키텍처를 구현할 때 유용
- 메시지큐는 Server To Server 비동기 소통을 위한 양식
- 대규모 프로세싱 Job을 좀 더 작게 분할해 개별 요소가 서로 독립적으로 작동할 수 있도록 한다. -> 배치 Job의 실행속도를 높여 워크로드 처리 성능을 높일 수 있다.
- 주요 기능
	- 각 리전에서 다중 AZ를 중복 구현 가능 -> 특정 AZ에 문제가 발생해도 서비스는 정상동작
	- 다수의 복제 메시지를 다중 AZ환경에 저장할 수 있으며, 최대 14일 유지된다. 
	- 메시지 프로듀서 또는 컨슈머 어플리케이션이 실패하더라도 메시지는 소실되지 않는다.
	- 분산 아키텍처 환경을 기반으로하므로 SQS는 별도의 프로비저닝 없이 확장하며 트래픽에 따라 스케일 업/다운을 실행한다.
	- 메시지는 최대 256KB의 XML, JSON, 포맷없는 텍스트 데이터를 담을 수 있다.
- SQS 큐 타입
	- 스탠다드 큐 : 초당 거의 무제한의 트랜잭션 지원. 전송 순서가 매우 중요한 경우 FIFO 큐 이용
	- FIFO 큐 : First In First Out. 순서보장. 초당 300회의 트랜잭션 제한
- SQS 환경 설정 시 파라미터
	- 메시지 보유기간 : 1분 ~14일
	- 초대 메시지 크기 : 1KB ~ 256KB
	- 전송지연 시간 : 0초 ~ 15분
		- 스탠다드큐의 큐별 지연설정은 이미 보함된 메시지에 영향을 주지 않는다. (불가역성)
		- FIFO큐의 큐별 지연설정은 이미 포함된 메시지에 영향을 준다. (가역성)
	- 수신 메시지 대기 시간
		- 숏폴링 - 큐에 메시지가 없는 경우 메시지 즉시 반환 -> 수신 메시지 대기시간 0초 설정 시 활성화
		- 롱폴링 - 큐에 메시지가 없는 경우 빈 메시지 응답. 메시지가 포함되지 않은 응답의 수를 줄여주고, 메시지가 준비되는 즉시 메시지를 전송해 SQS 이용 비용을 줄여준다. 수신 메시지대기시간 1~20초 설정시 활성화
	- 콘텐츠 기반 중복 제거 : FIFO 큐에서만 사용할 수 있는 파라미터
		- 콘텐츠 기반 중복제거 ID를 생성하기 위해 메시지 속성이 아닌 메시지 바디의 SHA-256 gotl dldyd
- SQS는 소스 큐 등 다른 큐가 처리하지 못한 메시지의 타깃 설정이 가능한 데드 레터 큐 (dead-letter queues) 기능 제공 
	- 데드레터 큐 : 오류 메시지만 따로 모아서 효율적인 디버깅 가능
- SQS에서 최대 수신 파라미터는 성공적으로 처리되지 못한 메시지를 데드 레터 큐로 전송하기 전 해당 메시지으 ㅣ초대 수신 횟수를 정의하며 최소 1에서 1000으로 설정할 수 있고, 데드 레터 큐 파라미터가 적용되는 큐만 따로 관리하도록 이름 지정이 가능하다.
- SQS는 SSE(Server-Side Encryption) 이용